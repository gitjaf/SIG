<div class="floating" alert title="titulo" message="mensaje" showon="alert" type="alertType" style="display: none;"></div>
<div class="row-fluid header">
	<div class="span12">
		<div class="span2 muted lead "><h3 class="module-name">SIG Tareas</h3></div>
		<div class="input-append span9 hidden-phone buscador">
			<input data-ng-model="query" type="search" placeholder="Buscar Tareas" class="span7">
			<button class="btn" data-ng-click="search(query)">&nbsp;<i class="icon-search"></i>&nbsp;</button><br>
		</div>	
	</div>
				<!-- <div class="row-fluid hidden-phone">
					
					
				</div> -->
</div>
<div class="container-fluid">
	
	<div class="row-fluid">
		<div class="span10">
			<!-- 
			<div class="row-fluid offset1 span8">
				<span style="margin-bottom: 0px" class="span4 lead muted">
					<small>Cambios Recientes:</small>
				</span>
			</div> 
				
			<div class="row-fluid offset1 span8 listado-tareas"  >
					<div class="row-fluid" data-ng-repeat="tarea in tareasRecientes" >
					
						<div id="tarea{{tarea.id}}" class="hoverDiv item-tareas" data-toggle="collapse" data-ng-href="#desc{{tarea.id}}" data-ng-mouseenter="showButtons=true" data-ng-mouseleave="showButtons=false">
							<div class="row-fluid span12">
								<span id="titulo-tarea-{{tarea.id}}"  class="lead has-tooltip txt-blue" data-tooltip data-title="{{tarea.asunto}}">{{tarea.asunto | cut:false:50}}  </span>
							
								<span data-ng-class="{label : tarea.estado}" class="{{(tarea.estado | lowercase).split(' ').join('')}}">
									{{tarea.estado}}
								</span>
								<span data-ng-class="{label : tarea.prioridad}" class="{{(tarea.prioridad | lowercase).split(' ').join('')}}">
									{{tarea.prioridad}}
								</span>
								<span class="badge" data-ng-show="tarea._embedded.tareasRelacionadas">{{tarea._embedded.tareasRelacionadas.length}}</span>
								
							</div>
							<div class="span12" style="margin-left: 2px;">
								<span class="muted" data-ng-show="tarea.fechaInicio"><small>{{tarea.fechaInicio | date:mediumDate}}</small></span>
								<span class="muted" data-ng-hide="tarea.fechaInicio"><small>Sin definir</small></span>
								<span class="muted" data-ng-show="tarea.fechaVencimiento"><small> - {{tarea.fechaVencimiento | date:mediumDate}}</small></span>
								<span class="muted" data-ng-hide="tarea.fechaVencimiento"><small> - Sin definir</small></span>
								<span class="muted" data-ng-show="tarea._embedded.tipo"><small> - {{tarea._embedded.tipo.nombre}}</small></span>
								<span class="muted" data-ng-hide="tarea._embedded.tipo"><small> - Sin definir</small></span>
								<div class="pull-right" data-ng-show="showButtons" >
									<div taskbuttons item="tarea" edit="editarTarea(tarea)" addsub="nuevaTarea(tarea)"></div>
								</div>

							</div>
							
							
							<div class="row-fluid collapse" id="desc{{tarea.id}}">
								<div class="span5" data-ng-show="tarea._embedded.asignados">
									Asignados: 
									<span class="muted" data-ng-repeat="asignado in tarea._embedded.asignados">{{asignado._embedded.persona.nombres}} {{asignado._embedded.persona.apellidos}}, </span>

								</div>
								<div class="span5" data-ng-show="tarea._embedded.asignados">
									Seguidores:
									<span class="muted" data-ng-repeat="seguidor in tarea._embedded.seguidores">{{seguidor._embedded.persona.nombres}} {{seguidor._embedded.persona.apellidos}}, </span>
								</div>
							<div class="span12 muted">{{tarea.descripcion}}</div>
						</div>
							
					</div>
										
				</div>
					
			</div>-->
			<div class="row-fluid offset1 span8 lead muted header-listado">
				<div class="span3"><small>Listado de Tareas:</small></div>
				<div class="span9">
						<a class="btn btn-primary pull-right" id="nueva" data-ng-click="nuevaTarea()" data-toggle="modal" data-target="#edit">Nueva</a>
				</div>
			</div>
			
			<div class="row-fluid offset1 span8 listado-tareas"  >
					<div class="row-fluid" data-ng-repeat="tarea in tareas._embedded.collection | filter: query | orderBy: orderProp" >
					
						<div id="tarea{{tarea.id}}" class="hoverDiv item-tareas" data-toggle="collapse" data-ng-href="#desc{{tarea.id}}" data-ng-mouseenter="showButtons=true" data-ng-mouseleave="showButtons=false">
							<div class="row-fluid span12">
								<span id="titulo-tarea-{{tarea.id}}"  class="lead has-tooltip txt-blue" data-tooltip data-title="{{tarea.asunto}}">{{tarea.asunto | cut:false:50}}  </span>
							
								<span data-ng-class="{label : tarea.estado}" class="{{(tarea.estado | lowercase).split(' ').join('')}}">
									{{tarea.estado}}
								</span>
								<span data-ng-class="{label : tarea.prioridad}" class="{{(tarea.prioridad | lowercase).split(' ').join('')}}">
									{{tarea.prioridad}}
								</span>
								<span class="badge" data-ng-show="tarea._embedded.tareasRelacionadas">{{tarea._embedded.tareasRelacionadas.length}}</span>
								
							</div>
							<div class="span12" style="margin-left: 2px;">
								<span class="muted" data-ng-show="tarea.fechaInicio"><small>{{tarea.fechaInicio | date:mediumDate}}</small></span>
								<span class="muted" data-ng-hide="tarea.fechaInicio"><small>Sin definir</small></span>
								<span class="muted" data-ng-show="tarea.fechaVencimiento"><small> - {{tarea.fechaVencimiento | date:mediumDate}}</small></span>
								<span class="muted" data-ng-hide="tarea.fechaVencimiento"><small> - Sin definir</small></span>
								<span class="muted" data-ng-show="tarea._embedded.tipo"><small> - {{tarea._embedded.tipo.nombre}}</small></span>
								<span class="muted" data-ng-hide="tarea._embedded.tipo"><small> - Sin definir</small></span>
								<div class="pull-right" data-ng-show="showButtons" >
									<div taskbuttons item="tarea" edit="editarTarea(tarea)" addsub="nuevaTarea(tarea)"></div>
								</div>

							</div>
							
							
							<div class="row-fluid collapse" id="desc{{tarea.id}}">
								<div class="span5" data-ng-show="tarea._embedded.asignados">
									Asignados: 
									<span class="muted" data-ng-repeat="asignado in tarea._embedded.asignados">{{asignado._embedded.persona.nombres}} {{asignado._embedded.persona.apellidos}}, </span>

								</div>
								<div class="span5" data-ng-show="tarea._embedded.asignados">
									Seguidores:
									<span class="muted" data-ng-repeat="seguidor in tarea._embedded.seguidores">{{seguidor._embedded.persona.nombres}} {{seguidor._embedded.persona.apellidos}}, </span>
								</div>
							<div class="span12 muted">{{tarea.descripcion}}</div>
						</div>
							
					</div>
										
				</div>
					
			</div>
				<div class="span2 hidden-phone">
					<div class="span12">
						<div class="muted"><small>Ordenar por:</small></div>
						<div class="offset1" data-ng-class="{activeLink: tareas.data.sortBy == 'asunto' }">
							<a data-ng-click="sort('asunto')">
								Asunto
							</a>
						</div>
						<div class="offset1" data-ng-class="{activeLink: tareas.data.sortBy == 'fechaInicio' }">
							<a data-ng-click="sort('fechaInicio')">
								Inicio
							</a>
						</div>
						<div class="offset1" data-ng-class="{activeLink: tareas.data.sortBy == 'fechaVencimiento' }">
							<a data-ng-click="sort('fechaVencimiento')">
								Vencimiento
							</a>
						</div>
						<div class="offset1" data-ng-class="{activeLink: tareas.data.sortBy == 'estado' }">
							<a  data-ng-click="sort('estado')">
								Estado
							</a>
						</div>
						<div class="offset1" data-ng-class="{activeLink: tareas.data.sortBy == 'prioridad' }">
							<a data-ng-click="sort('prioridad')">
								Prioridad
							</a>
						</div>
					</div>
					<!-- <div class="span2">
						<div class="muted"><small>{{tareas.data.total}} Tarea(s)</small></div>
					</div> -->
				</div>
			
				
				<pager collection="tareas"/>


			</div>
		</div>
		

	</div>

	<div data-ui-modal class="form fade slide left" data-ng-model="modal" id="edit">
		<div data-ng-include src="'./ng-views/form.html'" data-ng-controller="FormTareaCtrl">
		</div>
	</div>

	
</div>
